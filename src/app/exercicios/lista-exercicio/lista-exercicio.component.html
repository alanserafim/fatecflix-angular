
<body>
  <app-header></app-header>
  <div class="content"  *ngIf="usuarioLogado$ | async as user ">
    <button *ngIf="user.roles.includes('INSTRUTOR')" (click)="gotoCadastra()" mat-button type="submit">
      CADASTRAR EXERCICIOS
    </button>

    <mat-vertical-stepper [linear]="true" #stepper>
      <mat-step [stepControl]="selectAdvType" *ngFor="let exercicio of exercicios | async; let i=index">
        <form [formGroup]="selectAdvType">
          <ng-template matStepLabel >Exercicio {{ i + 1 }}</ng-template>
          <div class="exercicio">
            <h2 class="exercicio-titulo">{{ exercicio.titulo }}</h2>
            <mat-selection-list [disabled]="afirmativa.selectedOptions.selected[0]?.value" formControlName="firstCtrl" #afirmativa [multiple]="false">
              <mat-list-option  *ngFor="let afirmativa of exercicio.afirmativas; let i=index" [value]="afirmativa">
                <div class="alternativa">
                  <p>{{ afirmativa }}</p>
                </div>
              </mat-list-option>
            </mat-selection-list>
            <p class="resposta-correta" *ngIf="afirmativa.selectedOptions.selected[0]?.value === exercicio.resposta; else errado">Resposta correta!</p>
            <ng-template #errado><p class="resposta-errada" *ngIf="afirmativa.selectedOptions.selected[0]?.value !== null">Resposta incorreta!</p></ng-template>
          </div>
            <div>
              <!--<button *ngIf="i>0" mat-button matStepperPrevious>Anterior</button>-->
              <button mat-button matStepperNext matStepperNext (click)="respostas[i] = afirmativa.selectedOptions.selected[0]?.value"  [disabled]="!afirmativa.selectedOptions.selected[0]?.value">Responder</button>
              <button mat-button color="secondary" *ngIf="user.roles.includes('INSTRUTOR')" (click)="atualiza(exercicio.exercicioId)">Atualizar</button>
              <button mat-button color="warn" *ngIf="user.roles.includes('INSTRUTOR')" (click)="deleta(exercicio.exercicioId)">Deletar</button>
            </div>
        </form>
      </mat-step>
      <mat-step>
        <ng-template matStepLabel>Gabarito</ng-template>
        <p>Você chegou ao final dos exercícios propostos.</p>
        <p>Parabéns, continue assim!</p>
        <p class="altenartivas-selecionadas">Alternativas selecionadas</p>
        <div class="gabarito" *ngFor="let resposta of respostas, let i=index">
          <p>Questão {{ i + 1}}:</p>
          <p> &nbsp; {{ resposta }}</p>
        </div>
        <div class="buttons">
          <button mat-button (click)="stepper.reset()">Refazer</button>
          <button mat-button routerLink="/usuario/historico">Ir para Historico</button>
        </div>
      </mat-step>
    </mat-vertical-stepper >
  </div>
  <app-footer class="footer"></app-footer>
</body>

